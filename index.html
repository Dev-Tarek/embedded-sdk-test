<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Embedded SDK Test Console</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
            <rect width="32" height="32" rx="8" fill="currentColor" class="logo-bg"/>
            <path d="M8 16L14 10L20 16L14 22L8 16Z" fill="var(--bg-primary)"/>
            <path d="M14 16L20 10L26 16L20 22L14 16Z" fill="var(--bg-primary)" opacity="0.6"/>
          </svg>
        </div>
        <h1 class="header-title">Embedded SDK Test Console</h1>
      </div>
      <div class="header-right">
        <button id="theme-toggle" class="btn btn-icon" title="Toggle Theme">
          <svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Connection Status Bar -->
    <div class="status-bar">
      <div class="status-item">
        <span class="status-label">Status:</span>
        <span id="connection-status" class="status-badge status-disconnected">
          <span class="status-dot"></span>
          Waiting for Parent
        </span>
      </div>
      <div class="status-item">
        <span class="status-label">Parent Origin:</span>
        <code id="parent-origin" class="status-value">—</code>
      </div>
      <div class="status-item">
        <span class="status-label">Mode:</span>
        <code id="iframe-mode" class="status-value">iframe</code>
      </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Left Panel: Event Triggers -->
      <aside class="panel panel-triggers">
        <div class="panel-header">
          <h2 class="panel-title">Event Triggers</h2>
          <span class="panel-subtitle">Send events to parent</span>
        </div>

        <!-- Lifecycle Events -->
        <section class="event-section">
          <h3 class="section-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12,6 12,12 16,14"/>
            </svg>
            Lifecycle
          </h3>
          <div class="button-grid">
            <button class="btn btn-event" data-event="iframe.loading">
              <span class="btn-label">Initialize</span>
              <span class="btn-hint">iframe.loading</span>
            </button>
            <button class="btn btn-event" data-event="resize">
              <span class="btn-label">Resize</span>
              <span class="btn-hint">resize</span>
            </button>
            <button class="btn btn-event" data-event="loading-on">
              <span class="btn-label">Loading On</span>
              <span class="btn-hint">loading: true</span>
            </button>
            <button class="btn btn-event" data-event="loading-off">
              <span class="btn-label">Loading Off</span>
              <span class="btn-hint">loading: false</span>
            </button>
            <button class="btn btn-event" data-event="urlChange">
              <span class="btn-label">URL Change</span>
              <span class="btn-hint">urlChange</span>
            </button>
          </div>
        </section>

        <!-- Navigation Events -->
        <section class="event-section">
          <h3 class="section-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
              <polyline points="9,22 9,12 15,12 15,22"/>
            </svg>
            Navigation
          </h3>
          <div class="button-grid">
            <button class="btn btn-event" data-event="navigateTo">
              <span class="btn-label">Navigate To</span>
              <span class="btn-hint">navigateTo</span>
            </button>
            <button class="btn btn-event" data-event="redirect">
              <span class="btn-label">Redirect</span>
              <span class="btn-hint">redirect</span>
            </button>
            <button class="btn btn-event" data-event="breadcrumb">
              <span class="btn-label">Breadcrumb</span>
              <span class="btn-hint">breadcrumb</span>
            </button>
            <button class="btn btn-event" data-event="nav.primary-action">
              <span class="btn-label">Primary Action</span>
              <span class="btn-hint">nav.primary-action</span>
            </button>
            <button class="btn btn-event btn-warning" data-event="auth::required">
              <span class="btn-label">Auth Required</span>
              <span class="btn-hint">auth::required</span>
            </button>
            <button class="btn btn-event btn-warning" data-event="iframe.auth.refresh">
              <span class="btn-label">Auth Refresh</span>
              <span class="btn-hint">iframe.auth.refresh</span>
            </button>
          </div>
        </section>

        <!-- UI State Events -->
        <section class="event-section">
          <h3 class="section-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
              <line x1="3" y1="9" x2="21" y2="9"/>
              <line x1="9" y1="21" x2="9" y2="9"/>
            </svg>
            UI State
          </h3>
          <div class="button-grid">
            <button class="btn btn-event btn-toggle" data-event="overlay.open">
              <span class="btn-label">Overlay Open</span>
              <span class="btn-hint">overlay.open</span>
            </button>
            <button class="btn btn-event" data-event="overlay.close">
              <span class="btn-label">Overlay Close</span>
              <span class="btn-hint">overlay.close</span>
            </button>
            <button class="btn btn-event btn-toggle" data-event="doka.open">
              <span class="btn-label">Doka Open</span>
              <span class="btn-hint">doka.open</span>
            </button>
            <button class="btn btn-event" data-event="doka.close">
              <span class="btn-label">Doka Close</span>
              <span class="btn-hint">doka.close</span>
            </button>
            <button class="btn btn-event btn-toggle" data-event="open_salla_gpt">
              <span class="btn-label">GPT Open</span>
              <span class="btn-hint">open_salla_gpt</span>
            </button>
            <button class="btn btn-event" data-event="close_salla_gpt">
              <span class="btn-label">GPT Close</span>
              <span class="btn-hint">close_salla_gpt</span>
            </button>
          </div>
        </section>

        <!-- Business Events -->
        <section class="event-section">
          <h3 class="section-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
              <line x1="3" y1="6" x2="21" y2="6"/>
              <path d="M16 10a4 4 0 0 1-8 0"/>
            </svg>
            Business Events
          </h3>
          <div class="button-grid">
            <button class="btn btn-event btn-accent" data-event="checkout.create">
              <span class="btn-label">Checkout</span>
              <span class="btn-hint">checkout.create</span>
            </button>
            <button class="btn btn-event btn-accent" data-event="coupon.created">
              <span class="btn-label">Coupon</span>
              <span class="btn-hint">coupon.created</span>
            </button>
            <button class="btn btn-event btn-accent" data-event="page.added">
              <span class="btn-label">Page Added</span>
              <span class="btn-hint">page.added</span>
            </button>
            <button class="btn btn-event btn-accent" data-event="adBanner.create">
              <span class="btn-label">Ad Banner</span>
              <span class="btn-hint">adBanner.create</span>
            </button>
            <button class="btn btn-event btn-accent" data-event="abandonedCartReminder.sent">
              <span class="btn-label">Cart Reminder</span>
              <span class="btn-hint">abandonedCartReminder.sent</span>
            </button>
            <button class="btn btn-event btn-accent" data-event="store.identity.added">
              <span class="btn-label">Store Identity</span>
              <span class="btn-hint">store.identity.added</span>
            </button>
            <button class="btn btn-event btn-accent" data-event="sbc.added">
              <span class="btn-label">SBC Added</span>
              <span class="btn-hint">sbc.added</span>
            </button>
            <button class="btn btn-event btn-accent" data-event="dispatchMobileEvent">
              <span class="btn-label">Mobile Event</span>
              <span class="btn-hint">dispatchMobileEvent</span>
            </button>
          </div>
        </section>
      </aside>

      <!-- Right Panel: Logs & Data -->
      <div class="panel-right">
        <!-- Message Log -->
        <section class="panel panel-log">
          <div class="panel-header">
            <div>
              <h2 class="panel-title">Message Log</h2>
              <span class="panel-subtitle">Real-time event stream</span>
            </div>
            <div class="panel-actions">
              <button id="clear-log" class="btn btn-small" title="Clear Log">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3,6 5,6 21,6"/>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                </svg>
                Clear
              </button>
              <button id="copy-log" class="btn btn-small" title="Copy Log">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                </svg>
                Copy
              </button>
            </div>
          </div>
          <div id="message-log" class="log-container">
            <div class="log-empty">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
              </svg>
              <p>No messages yet</p>
              <span>Click "Initialize" to start communication</span>
            </div>
          </div>
        </section>

        <!-- Received Data -->
        <section class="panel panel-data">
          <div class="panel-header">
            <div>
              <h2 class="panel-title">Received Data</h2>
              <span class="panel-subtitle">Data from parent window</span>
            </div>
          </div>
          <div id="received-data" class="data-container">
            <div class="data-grid">
              <div class="data-item">
                <span class="data-label">Store ID</span>
                <span id="data-store-id" class="data-value">—</span>
              </div>
              <div class="data-item">
                <span class="data-label">User ID</span>
                <span id="data-user-id" class="data-value">—</span>
              </div>
              <div class="data-item">
                <span class="data-label">Plan</span>
                <span id="data-plan" class="data-value">—</span>
              </div>
              <div class="data-item">
                <span class="data-label">Dark Mode</span>
                <span id="data-dark-mode" class="data-value">—</span>
              </div>
              <div class="data-item">
                <span class="data-label">Token</span>
                <span id="data-token" class="data-value data-value-truncate">—</span>
              </div>
              <div class="data-item">
                <span class="data-label">Base URL</span>
                <span id="data-base-url" class="data-value data-value-truncate">—</span>
              </div>
              <div class="data-item">
                <span class="data-label">Base API URL</span>
                <span id="data-base-api-url" class="data-value data-value-truncate">—</span>
              </div>
              <div class="data-item">
                <span class="data-label">Parent Width</span>
                <span id="data-parent-width" class="data-value">—</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Payload Editor -->
        <section class="panel panel-editor">
          <div class="panel-header">
            <div>
              <h2 class="panel-title">Payload Editor</h2>
              <span class="panel-subtitle">Customize event data</span>
            </div>
            <div class="panel-actions">
              <button id="send-custom" class="btn btn-small btn-primary">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="22" y1="2" x2="11" y2="13"/>
                  <polygon points="22,2 15,22 11,13 2,9"/>
                </svg>
                Send
              </button>
            </div>
          </div>
          <div class="editor-container">
            <textarea id="payload-editor" class="payload-textarea" spellcheck="false">{
  "event": "custom.event",
  "data": {}
}</textarea>
          </div>
        </section>
      </div>
    </main>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>
  </div>

  <script src="events.js"></script>
  <script src="app.js"></script>
</body>
</html>

